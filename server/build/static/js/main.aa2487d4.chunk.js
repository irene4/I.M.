(this.webpackJsonpmssg=this.webpackJsonpmssg||[]).push([[0],{38:function(e,t,n){e.exports=n(76)},43:function(e,t,n){},71:function(e,t){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(32),c=n.n(s),l=(n(43),n(1)),i=(n(44),n(2)),o=n(33),u=n(34),m=n(3),d=n(37),f=n(36),g=n(18);function b(e,t){var n="im-"+e,r=Object(a.useState)((function(){var e=localStorage.getItem(n);return null!=e?JSON.parse(e):"function"===typeof t?t():t})),s=Object(l.a)(r,2),c=s[0],i=s[1];return Object(a.useEffect)((function(){localStorage.setItem(n,JSON.stringify(c))}),[n,c]),[c,i]}var p=n(35),h=n.n(p),v=Object(a.createContext)();function E(e){var t=e.user,n=e.children,s=Object(a.useState)(),c=Object(l.a)(s,2),i=c[0],o=c[1];return Object(a.useEffect)((function(){var e=h()({query:{user:t}});return o(e),function(){return e.close()}}),[t]),r.a.createElement(v.Provider,{value:i},n)}var y=Object(a.createContext)();function O(){return Object(a.useContext)(y)}function j(e){var t=e.user,n=e.children,s=b("chats",[]),c=Object(l.a)(s,2),o=c[0],u=c[1],m=Object(a.useContext)(v);function d(){var e=document.getElementById("box");e&&(e.scrollTop=e.scrollHeight)}var f=Object(a.useCallback)((function(e){var t=e.recip,n=e.txt,a=e.sender;u((function(e){var r={sender:a,txt:n},s=e.map((function(e){return e.user===t||a===e.user?Object(i.a)(Object(i.a)({},e),{},{messages:[].concat(Object(g.a)(e.messages),[r])}):e}));return d(),s}))}),[u]);return Object(a.useEffect)((function(){if(d(),null!=m)return m.on("get mssg!",f),function(){return m.off("get mssg!")}}),[m,f]),r.a.createElement(y.Provider,{value:{chats:o,createChat:function(e){u((function(t){return[].concat(Object(g.a)(t),[{user:e,messages:[]}])}))},sendMssg:function(e,n){m.emit("send mssg!",{recip:e,txt:n}),f({recip:e,txt:n,sender:t})}}}," ",n," ")}function w(e){var t=e.setBuddy,n=O().chats;return r.a.createElement("ul",null,n.map((function(e,n){return r.a.createElement("li",{key:n,style:{color:"green",fontWeight:"bold",cursor:"pointer"}},r.a.createElement("div",{onClick:function(n){t(e.user)}},e.user))})))}function x(e){var t=O(),n=t.chats,s=t.sendMssg,c=Object(a.useState)(""),i=Object(l.a)(c,2),o=i[0],u=i[1],m=n.find((function(t){return t.user===e.recip}));function d(t){t.preventDefault(),o&&s(e.recip,o),u("")}return r.a.createElement("div",null,r.a.createElement("div",{id:"box",style:{height:"14rem",width:"20rem",overflow:"auto"}},r.a.createElement("ul",{style:{listStyle:"none"}},0==m.messages.length&&r.a.createElement("label",null,r.a.createElement("strong",{style:{color:"green"}},"New chat with ",e.recip,".")),m&&m.messages.map((function(t,n){return r.a.createElement("li",{key:n},r.a.createElement("label",null,r.a.createElement("strong",{style:t.sender===e.user?{color:"blue"}:{color:"green"}},t.sender,": "),"   ",t.txt))})))),r.a.createElement("form",{onSubmit:d},r.a.createElement("div",{className:"field-row-stacked",style:{width:"100%",position:"absolute",bottom:"0"}},r.a.createElement("label",{style:{paddingLeft:".5rem"}}," Chatbox:"),r.a.createElement("textarea",{id:"chatbox",rows:"3",value:o,onChange:function(e){return u(e.target.value)},onKeyDown:function(e){13===e.keyCode&&d(e)},style:{resize:"none"},required:!0}),r.a.createElement("button",{type:"submit",style:{width:"30px"}},"Send"))))}function C(e){var t=e.user,n=Object(a.useRef)(),s=O().createChat,c=b("buddy",[]),i=Object(l.a)(c,2),o=i[0],u=i[1];return r.a.useEffect((function(){}),[]),r.a.createElement("div",{style:{width:"30rem",display:"in-line block"}},r.a.createElement("aside",null,r.a.createElement("ul",{className:"tree-view",style:{float:"left",width:"8rem"}},r.a.createElement("li",null,"Welcome,",r.a.createElement("span",{style:{color:"blue"}}," ",t)),r.a.createElement("li",{style:{paddingTop:"1rem"}},"Chats",r.a.createElement(w,{setBuddy:u})),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),s(n.current.value),u(n.current.value),n.current.value=""},style:{paddingTop:"1rem"}},r.a.createElement("div",{className:"field-row-stacked"},r.a.createElement("label",null,"New chat with:"),r.a.createElement("input",{id:"newChat",type:"text",placeholder:"Username...",autoComplete:"off",ref:n,required:!0}),r.a.createElement("button",{type:"submit"},"Go"))))),r.a.createElement("div",{style:{height:"20rem",width:"20rem",position:"relative",display:"inline-block",marginLeft:"5px",backgroundColor:"white"}},r.a.createElement(x,{user:t,recip:o})))}function k(e){var t=e.setUser,n=Object(a.useRef)();return r.a.createElement("div",null,r.a.createElement("label",null,"screen name:"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(n.current.value)}},r.a.createElement("input",{type:"text",ref:n,required:!0}),r.a.createElement("button",{type:"submit"},"Log in")))}n(74);var D=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={X:0,Y:0,dragging:!1,styles:{top:a.props.initTop,left:a.props.initLeft,zIndex:0}},a.startDrag=a.startDrag.bind(Object(m.a)(a)),a.toFront=a.toFront.bind(Object(m.a)(a)),a.dragging=a.dragging.bind(Object(m.a)(a)),a.stopDrag=a.stopDrag.bind(Object(m.a)(a)),window.addEventListener("mousemove",a.dragging),a}return Object(u.a)(n,[{key:"startDrag",value:function(e){e.preventDefault();var t=this.props.highestZ+1;this.props.incZ(t),this.setState({X:e.screenX-e.currentTarget.getBoundingClientRect().left,Y:e.screenY-e.currentTarget.getBoundingClientRect().top,highestZ:t,dragging:!0,styles:Object(i.a)(Object(i.a)({},this.state.styles),{},{zIndex:t})})}},{key:"toFront",value:function(e){var t=this.props.highestZ+1;this.props.incZ(t),this.setState({highestZ:t,styles:Object(i.a)(Object(i.a)({},this.state.styles),{},{zIndex:t})})}},{key:"dragging",value:function(e){if(e.preventDefault(),this.state.dragging){var t=e.screenX-this.state.X,n=e.screenY-this.state.Y;this.setState({styles:Object(i.a)(Object(i.a)({},this.state.styles),{},{left:t,top:n})})}}},{key:"isTopWindow",value:function(){return this.state.styles.zIndex===this.props.highestZ}},{key:"stopDrag",value:function(e){e.preventDefault(),this.setState({dragging:!1})}},{key:"render",value:function(){return r.a.createElement("div",{className:"wind0w",style:this.state.styles},r.a.createElement("div",{className:"window"},r.a.createElement("div",{className:"title-bar",style:{cursor:"grab"},onMouseDown:this.startDrag,onMouseUp:this.stopDrag},r.a.createElement("div",{className:"title-bar-text"},"Instant Messenger"),r.a.createElement("div",{className:"title-bar-controls"},r.a.createElement("button",{"aria-label":"Minimize",onDoubleClick:function(){return console.log("Double clicked!")}}),r.a.createElement("button",{"aria-label":"Maximize"}),r.a.createElement("button",{"aria-label":"Close"}))),r.a.createElement("div",{className:"window-body",onMouseDown:this.toFront},r.a.createElement("p",{style:{textAlign:"center",userSelect:"none"}}),r.a.createElement("div",{className:"field-row",style:{justifyContent:"center"}}),this.props.user?r.a.createElement(C,{user:this.props.user}):r.a.createElement(k,{setUser:this.props.setUser}))))}}]),n}(a.Component);n(75);function S(){var e=a.useState(0),t=Object(l.a)(e,2),n=t[0],r=t[1],s=b("user",""),c=Object(l.a)(s,2),i=c[0],o=c[1];return a.createElement("div",{className:"App"},a.createElement(E,{user:i},a.createElement(j,{user:i},a.createElement(D,{user:i,setUser:o,incZ:r,highestZ:n,initTop:30,initLeft:150}))))}c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(S,null)),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.aa2487d4.chunk.js.map